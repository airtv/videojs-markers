/*! videojs-markers - v1.0.1 - 2022-03-15
* Copyright (c) 2022 ; Licensed  */
!function(e,r){"function"==typeof define&&define.amd?define(["video.js"],r):"undefined"!=typeof exports?r(require("video.js")):(r(e.videojs),e.videojsMarkers={})}(this,function(e){"use strict";var x=(e=e)&&e.__esModule?e:{default:e};var b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T={markerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,text:function(e){return"Break: "+e.text},time:function(e){return e.time}},breakOverlay:{display:!1,displayTime:3,text:function(e){return"Break overlay: "+e.overlayText},style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}},onMarkerClick:function(e){},onMarkerReached:function(e,r){},markers:[]};function g(e){var r;try{r=e.getBoundingClientRect()}catch(e){r={top:0,bottom:0,left:0,width:0,height:0,right:0}}return r}var j=-1;x.default.registerPlugin("markers",function(n){x.default.mergeOptions||(o=function(e){return!!e&&"object"===(void 0===e?"undefined":b(e))&&"[object Object]"===toString.call(e)&&e.constructor===Object},x.default.mergeOptions=function i(e,r){var a={};return[e,r].forEach(function(t){t&&Object.keys(t).forEach(function(e){var r=t[e];o(r)?(o(a[e])||(a[e]={}),a[e]=i(a[e],r)):a[e]=r})}),a}),x.default.dom.createEl||(x.default.dom.createEl=function(e,r,t){var i=x.default.Player.prototype.dom.createEl(e,r);return t&&Object.keys(t).forEach(function(e){i.setAttribute(e,t[e])}),i});var o,l=x.default.mergeOptions(T,n),i={},u=[],d=j,s=this,a=null,c=null,f=j;function r(){u.sort(function(e,r){return l.markerTip.time(e)-l.markerTip.time(r)})}function t(e){e.forEach(function(e){var t;e.key=(t=(new Date).getTime(),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var r=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?r:3&r|8).toString(16)})),s.el().querySelector(".vjs-progress-holder").appendChild(function(t){var e=x.default.dom.createEl("div",{},{"data-marker-key":t.key,"data-marker-time":l.markerTip.time(t)});y(t,e),e.addEventListener("click",function(e){var r=!1;(r="function"==typeof l.onMarkerClick?!1===l.onMarkerClick(t):r)||(r=this.getAttribute("data-marker-key"),s.currentTime(l.markerTip.time(i[r])))}),l.markerTip.display&&function(t){t.addEventListener("mouseover",function(){var e,r=i[t.getAttribute("data-marker-key")];a&&(l.markerTip.html?a.querySelector(".vjs-tip-inner").innerHTML=l.markerTip.html(r):a.querySelector(".vjs-tip-inner").innerText=l.markerTip.text(r),a.style.left=k(r)+"%",r=g(a),e=g(t),a.style.marginLeft=-parseFloat(r.width/2)+parseFloat(e.width/4)+"px",a.style.visibility="visible")}),t.addEventListener("mouseout",function(){a&&(a.style.visibility="hidden")})}(e);return e}(e)),i[e.key]=e,u.push(e)}),r()}function m(e){isNaN(s.duration())||0==s.duration()?s.markers.addMarkersQueue.push(e):t(e)}function k(e){return l.markerTip.time(e)/s.duration()*100}function y(e,r){r.className="vjs-marker "+(e.class||""),Object.keys(l.markerStyle).forEach(function(e){r.style[e]=l.markerStyle[e]});var t=e.time/s.duration();(t<0||1<t)&&(r.style.display="none"),r.style.left=k(e)+"%",e.duration?(r.style.width=e.duration/s.duration()*100+"%",r.style.marginLeft="0px"):(t=g(r),r.style.marginLeft=t.width/2+"px")}function v(e){c&&(f=j,c.style.visibility="hidden"),d=j;var t=[];e.forEach(function(e){var r=u[e];r&&(delete i[r.key],t.push(e),(e=s.el().querySelector(".vjs-marker[data-marker-key='"+r.key+"']"))&&e.parentNode.removeChild(e))}),t.reverse(),t.forEach(function(e){u.splice(e,1)}),r()}function e(){var e,r,t;!l.breakOverlay.display||d<0||(e=s.currentTime(),r=u[d],(t=l.markerTip.time(r))<=e&&e<=t+l.breakOverlay.displayTime?(f!==d&&(f=d,c&&(c.querySelector(".vjs-break-overlay-text").innerHTML=l.breakOverlay.text(r))),c&&(c.style.visibility="visible")):(f=j,c&&(c.style.visibility="hidden")))}function p(){!function(){if(u.length){var e=function(e){return e<u.length-1?l.markerTip.time(u[e+1]):s.duration()},r=s.currentTime(),t=j;if(d!==j){var i=e(d);if(r>=l.markerTip.time(u[d])&&r<i)return;if(d===u.length-1&&r===s.duration())return}if(r<l.markerTip.time(u[0]))t=j;else for(var a=0;a<u.length;a++)if(i=e(a),r>=l.markerTip.time(u[a])&&r<i){t=a;break}t!==d&&(t!==j&&n.onMarkerReached&&n.onMarkerReached(u[t],t),d=t)}}(),e(),n.onTimeUpdateAfterMarkerUpdate&&n.onTimeUpdateAfterMarkerUpdate()}function h(){l.markerTip.display&&(a=x.default.dom.createEl("div",{className:"vjs-tip",innerHTML:"<div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div>"}),s.el().querySelector(".vjs-progress-holder").appendChild(a)),s.markers.removeAll(),m(l.markers),l.breakOverlay.display&&(c=x.default.dom.createEl("div",{className:"vjs-break-overlay",innerHTML:"<div class='vjs-break-overlay-text'></div>"}),Object.keys(l.breakOverlay.style).forEach(function(e){c&&(c.style[e]=l.breakOverlay.style[e])}),s.el().appendChild(c),f=j),p(),s.on("timeupdate",p),s.off("loadedmetadata")}s.on("loadedmetadata",function(){h();for(var e;e=s.markers.addMarkersQueue.shift();)t(e)}),s.markers={addMarkersQueue:[],getMarkers:function(){return u},next:function(){for(var e=s.currentTime(),r=0;r<u.length;r++){var t=l.markerTip.time(u[r]);if(e<t){s.currentTime(t);break}}},prev:function(){for(var e=s.currentTime(),r=u.length-1;0<=r;r--){var t=l.markerTip.time(u[r]);if(t+.5<e)return void s.currentTime(t)}},add:function(e){m(e)},remove:function(e){v(e)},removeAll:function(){for(var e=[],r=0;r<u.length;r++)e.push(r);v(e)},updateTime:function(e){var i;i=e,u.forEach(function(e){var r=s.el().querySelector(".vjs-marker[data-marker-key='"+e.key+"']"),t=l.markerTip.time(e);!i&&r.getAttribute("data-marker-time")===t||(y(e,r),r.setAttribute("data-marker-time",t))}),r()},reset:function(e){s.markers.removeAll(),m(e)},destroy:function(){s.markers.removeAll(),c&&c.remove(),a&&a.remove(),s.off("timeupdate",e),delete s.markers}}})});